<%- include('./partials/header') %>
    <div class="w-full min-h-screen px-20 py-20 bg-gray-50">
        <h1 class="text-2xl font-semibold mb-8">Your Cart</h1>
        
        <div class="flex gap-8">
            <!-- Main Cart Content -->
            <div class="w-2/3">
        
        <% if (!cartItems || cartItems.length === 0) { %>
            <div class="text-center py-10">
                <p class="text-gray-500">Your cart is empty</p>
                <a href="/shop" class="inline-block mt-4 px-6 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600">
                    Continue Shopping
                </a>
            </div>
        <% } else { %>
            <div class="flex flex-col gap-6">
                <% if (!cartItems || cartItems.length === 0) { %>
                    <div class="text-center py-10">
                        <p class="text-gray-500">Your cart is empty</p>
                        <a href="/shop" class="inline-block mt-4 px-6 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600">
                            Continue Shopping
                        </a>
                    </div>
                <% } else { %>
                    <% cartItems.forEach(function(item) { %>
                        <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                            <div class="flex items-center p-6">
                                <div class="w-32 h-32 bg-gray-100 rounded-lg flex items-center justify-center overflow-hidden">
                                    <% if (item.image) { %>
                                        <img class="h-28 object-contain" 
                                             src="data:image/jpeg;base64,<%= item.image.toString('base64') %>" 
                                             alt="<%= item.name %>">
                                    <% } else { %>
                                        <div class="text-gray-400">No Image</div>
                                    <% } %>
                                </div>
                                
                                <div class="flex-grow ml-6">
                                    <h3 class="text-xl font-semibold"><%= item.name %></h3>
                                    <p class="text-gray-500">₹ <%= item.price %></p>
                                </div>
                                
                                <div class="flex items-center gap-4">
                                    <div class="flex items-center gap-2">
                                        <a href="/cart/decrease/<%= item._id %>" 
                                           class="w-8 h-8 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200">
                                            <i class="ri-subtract-line"></i>
                                        </a>
                                        <span class="w-12 text-center"><%= item.quantity %></span>
                                        <a href="/cart/increase/<%= item._id %>"
                                           class="w-8 h-8 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200">
                                            <i class="ri-add-line"></i>
                                        </a>
                                    </div>
                                    
                                    <a href="/cart/remove/<%= item._id %>" 
                                       class="text-red-500 hover:text-red-600">
                                        <i class="ri-delete-bin-line text-xl"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    <% }); %>
                <% } %>
            </div>
            </div>

            <!-- Right Side - Price Details -->
            <div class="w-1/3">
                <div class="bg-white rounded-lg shadow-sm p-6 sticky top-24">
                    <h3 class="text-xl font-semibold mb-6">Price Details</h3>
                    
                    <div class="space-y-4">
                        <% 
                            let subtotal = 0;
                            let totalDiscount = 0;
                            cartItems.forEach(item => {
                                subtotal += item.price * item.quantity;
                                totalDiscount += (item.discount || 0) * item.quantity;
                            });
                        %>
                        <!-- Subtotal -->
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">Price (<%= cartItems.length %> items)</span>
                            <span>₹ <%= subtotal %></span>
                        </div>

                        <!-- Discount -->
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">Discount</span>
                            <span class="text-green-500">- ₹ <%= Math.floor(totalDiscount) %></span>
                        </div>

                        <!-- Shipping -->
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">Shipping Charge</span>
                            <% const shippingCharge = total > 1000 ? 0 : 50; %>
                            <% if (shippingCharge === 0) { %>
                                <span class="text-green-500">Free</span>
                            <% } else { %>
                                <span>₹ <%= shippingCharge %></span>
                            <% } %>
                        </div>

                        <!-- Divider -->
                        <div class="border-t border-gray-200 my-4"></div>

                        <!-- Total -->
                        <div class="flex justify-between items-center font-semibold text-lg">
                            <span>Total Amount</span>
                            <% const finalTotal = subtotal - totalDiscount + shippingCharge; %>
                            <span>₹ <%= Math.floor(finalTotal) %></span>
                        </div>

                        <!-- Savings -->
                        <div class="text-green-500 text-sm mt-4">
                            You will save ₹ <%= Math.floor(totalDiscount) %> on this order
                        </div>
                    </div>

                    <div class="flex flex-col gap-4 mt-6">
                        <a href="/checkout" 
                           class="w-full py-3 px-4 bg-blue-500 text-white text-center rounded-md hover:bg-blue-600">
                            Proceed to Checkout
                        </a>
                        <a href="/shop" 
                           class="w-full py-3 px-4 border border-gray-300 text-center rounded-md hover:bg-gray-50">
                            Continue Shopping
                        </a>
                    </div>
                </div>
            </div>
        <% } %>
        </div>
    </div>
   
           
        </div>
    </div>
    <%- include('./partials/footer') %>